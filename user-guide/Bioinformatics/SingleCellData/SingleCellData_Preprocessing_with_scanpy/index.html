<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Lamine TOURE">
        <link rel="canonical" href="https://LamineTourelab.github.io/LamineTourelab/user-guide/Bioinformatics/SingleCellData/SingleCellData_Preprocessing_with_scanpy/">
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Installation - LamineTourelab</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">LamineTourelab</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../../USER_GUIDE_INDEX/" class="nav-link">Getting Started</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../USER_GUIDE_INDEX/" class="dropdown-item">User Guide Index</a>
</li>
                                    
<li>
    <a href="../../../" class="dropdown-item">None</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Bioinformatics</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../RNA_Velocity_analysis_scVelo/" class="dropdown-item">Getting Started with RNA Velocity</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Installation</a>
</li>
            
<li>
    <a href="../Trajectory_inference_With_CellRank/Trajectory_inference_With_CellRank/" class="dropdown-item">Getting Started with CellRank</a>
</li>
            
<li>
    <a href="../Readme/" class="dropdown-item">Tutorials</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Machine learning</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../Machine%20learning/Autoencoder/Autoencoder/" class="dropdown-item">Autoencoder</a>
</li>
            
<li>
    <a href="../../../Machine%20learning/DecisionTrees_using_iris_dataset/DecisionTrees_using_iris_dataset/" class="dropdown-item">DecisionTrees using iris dataset</a>
</li>
            
<li>
    <a href="../../../Machine%20learning/Transfer_learning_using_VGG16/Transfer_learning_using_VGG16/" class="dropdown-item">Transfer learning using VGG16</a>
</li>
            
<li>
    <a href="../../../Machine%20learning/tensorflow_API_tutorial/tensorflow_API_tutorial/" class="dropdown-item">tensorflow API tutorial</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ExplainabilityAI</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../ExplainabilityAI/explainability_shap%26lime/" class="dropdown-item">Explainability shap&lime</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../about/contributing/" class="dropdown-item">Contributing</a>
</li>
                                    
<li>
    <a href="../../../../about/license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../RNA_Velocity_analysis_scVelo/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Trajectory_inference_With_CellRank/Trajectory_inference_With_CellRank/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/LamineTourelab/Tutorial/tree/main/docs/user-guide/Bioinformatics/SingleCellData/SingleCellData_Preprocessing_with_scanpy.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#installation" class="nav-link">Installation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#read-and-preprocessing-the-datasets" class="nav-link">Read and preprocessing the datasets</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#detect-variables-genes" class="nav-link">Detect variables genes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#data-integration-batch-effect-correction" class="nav-link">Data integration : batch effect correction</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#cell-type-automatic-annotation-from-marker-genes" class="nav-link">Cell type automatic annotation from marker genes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link"></a></h1>
<h1 id="read-and-preprocessing-the-datasets">Read and preprocessing the datasets<a class="headerlink" href="#read-and-preprocessing-the-datasets" title="Permanent link"></a></h1>
<p>The dataset contains control and IFN-beta stimulated cells. We use this as the query dataset.</p>
<pre class="highlight"><code class="language-python">from platform import python_version

print(python_version())</code></pre>
<pre class="highlight"><code>3.11.7</code></pre>
<pre class="highlight"><code class="language-python">import numpy as np
import pandas as pd
import scanpy as sc
import anndata as ad
import decoupler as dc
import session_info</code></pre>
<pre class="highlight"><code class="language-python">import matplotlib.pyplot as plt

sc.settings.verbosity = 3             # verbosity: errors (0), warnings (1), info (2), hints (3)
#sc.logging.print_versions()

sc.settings.set_figure_params(dpi=80)
%matplotlib inline</code></pre>
<pre class="highlight"><code class="language-python">sc.settings.verbosity = 3             # verbosity: errors (0), warnings (1), info (2), hints (3)
sc.logging.print_header()
sc.settings.set_figure_params(dpi=80, facecolor='white')</code></pre>
<pre class="highlight"><code>/Users/lamine/anaconda3/envs/env/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm


scanpy==1.9.6 anndata==0.10.4 umap==0.5.5 numpy==1.26.3 scipy==1.12.0 pandas==2.2.0 scikit-learn==1.4.0 statsmodels==0.14.1 pynndescent==0.5.11</code></pre>
<pre class="highlight"><code class="language-python">results_file = '/path/Data/file_merged.h5ad'  
#the file that will store the analysis results</code></pre>
<pre class="highlight"><code class="language-python">SS001 = sc.read_10x_mtx(
    '/path/SS001/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)
SS002 = sc.read_10x_mtx(
    '/path/SS002/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)  
SS003 = sc.read_10x_mtx(
    '/path/SS003/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)  
SS004 = sc.read_10x_mtx(
    '/path/SS004/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True) 

SS005 = sc.read_10x_mtx(
    '/path/SS005/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)
SS006 = sc.read_10x_mtx(
    '/path/SS006/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)  
SS007 = sc.read_10x_mtx(
    '/path/SS007/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)  
SS008 = sc.read_10x_mtx(
    '/path/SS008/outs/filtered_gene_bc_matrices/GRCh38',  # the directory with the `.mtx` file
    var_names='gene_symbols',                # use gene symbols for the variable names (variables-axis index)
    cache=True)  
</code></pre>
<pre class="highlight"><code class="language-python">file_merged = ad.concat([SS001, SS002, SS003, SS004, SS005, SS006, SS007, SS008], label="batch", 
                            keys=["SS001", "SS002", "SS003", "SS004", "SS005", "SS006", "SS007", "SS008"])
file_merged</code></pre>
<pre class="highlight"><code class="language-python">file_merged.obs['condition'] = 'WT'
file_merged.obs</code></pre>
<pre class="highlight"><code class="language-python">Trait = file_merged.obs.batch=='D6'
file_merged.obs.loc[Trait, 'condition'] = 'IRF3&amp;IFNb&amp;vRNA'
file_merged.obs['condition']</code></pre>
<pre class="highlight"><code class="language-python">file_merged.var_names_make_unique()  # this is unnecessary if using `var_names='gene_ids'` in `sc.read_10x_mtx`
file_merged</code></pre>
<h2 id="detect-variables-genes">Detect variables genes<a class="headerlink" href="#detect-variables-genes" title="Permanent link"></a></h2>
<p>Variable genes can be detected across the full dataset, but then we run the risk of getting many batch-specific genes that will drive a lot of the variation. Or we can select variable genes from each batch separately to get only celltype variation. In the dimensionality reduction exercise, we already selected variable genes, so they are already stored in file_merged.var.highly_variable</p>
<pre class="highlight"><code class="language-python">sc.pl.highest_expr_genes(file_merged, n_top=20, )</code></pre>
<pre class="highlight"><code class="language-python">sc.pp.filter_cells(file_merged, min_genes=200)
sc.pp.filter_genes(file_merged, min_cells=3)</code></pre>
<pre class="highlight"><code class="language-python">file_merged.var['mt'] = file_merged.var_names.str.startswith('MT-')  
# annotate the group of mitochondrial genes as 'mt'
sc.pp.calculate_qc_metrics(file_merged, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)</code></pre>
<pre class="highlight"><code class="language-python">file_merged</code></pre>
<pre class="highlight"><code class="language-python">#leg = ax.legend() 
sc.pl.violin(file_merged, ['n_genes_by_counts', 'total_counts', 'pct_counts_mt'],
             jitter=0.4, multi_panel=True)</code></pre>
<pre class="highlight"><code class="language-python">file_merged = file_merged[file_merged.obs.n_genes_by_counts &lt; 8500, :]
file_merged = file_merged[file_merged.obs.pct_counts_mt &lt; 20 , :]</code></pre>
<pre class="highlight"><code class="language-python">file_merged</code></pre>
<pre class="highlight"><code class="language-python">file_merged.layers['counts']= file_merged.X.copy()
sc.pp.normalize_total(file_merged, target_sum=1e4)</code></pre>
<pre class="highlight"><code class="language-python">sc.pp.log1p(file_merged)</code></pre>
<pre class="highlight"><code class="language-python">sc.pp.highly_variable_genes(file_merged, min_mean=0.0125, max_mean=3, min_disp=0.5)</code></pre>
<pre class="highlight"><code class="language-python">var_genes_all = file_merged.var.highly_variable

print("Highly variable genes: %d"%sum(var_genes_all))</code></pre>
<p>Detect variable genes in each dataset separately using the batch_key parameter.</p>
<pre class="highlight"><code class="language-python">sc.pp.highly_variable_genes(file_merged, min_mean=0.0125, max_mean=3, min_disp=0.5, batch_key = 'batch')

print("Highly variable genes intersection: %d"%sum(file_merged.var.highly_variable_intersection))

print("Number of batches where gene is variable:")
print(file_merged.var.highly_variable_nbatches.value_counts())

var_genes_batch = file_merged.var.highly_variable_nbatches &gt; 0</code></pre>
<p>Compare overlap of the variable genes.</p>
<pre class="highlight"><code class="language-python">print("Any batch var genes: %d"%sum(var_genes_batch))
print("All data var genes: %d"%sum(var_genes_all))
print("Overlap: %d"%sum(var_genes_batch &amp; var_genes_all))
print("Variable genes in all batches: %d"%sum(file_merged.var.highly_variable_nbatches == 6))
print("Overlap batch instersection and all: %d"%sum(var_genes_all &amp; file_merged.var.highly_variable_intersection))</code></pre>
<p>Select all genes that are variable in at least 2 datasets and use for remaining analysis.</p>
<pre class="highlight"><code class="language-python">var_select = file_merged.var.highly_variable_nbatches &gt; 2
var_genes = var_select.index[var_select]
len(var_genes)</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.highly_variable_genes(file_merged)</code></pre>
<pre class="highlight"><code class="language-python">file_merged.raw = file_merged</code></pre>
<pre class="highlight"><code class="language-python">file_merged = file_merged[:, file_merged.var.highly_variable]
sc.pp.regress_out(file_merged, ['total_counts', 'pct_counts_mt'])
sc.pp.scale(file_merged, max_value=10)</code></pre>
<h2 id="data-integration-batch-effect-correction">Data integration : batch effect correction<a class="headerlink" href="#data-integration-batch-effect-correction" title="Permanent link"></a></h2>
<h3 id="bbknn">BBKNN<a class="headerlink" href="#bbknn" title="Permanent link"></a></h3>
<p>First we will run BBKNN that is implemented in scanpy.</p>
<pre class="highlight"><code class="language-python">sc.tl.pca(file_merged, svd_solver='arpack')
sc.pl.pca_variance_ratio(file_merged, log=True)</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn = file_merged</code></pre>
<pre class="highlight"><code class="language-python">sc.external.pp.bbknn(file_merged_bbknn, batch_key='batch', n_pcs=30)  
</code></pre>
<pre class="highlight"><code class="language-python">sc.pp.neighbors(file_merged, n_neighbors=10, n_pcs=30)
sc.tl.leiden(file_merged)
sc.tl.paga(file_merged)
sc.pl.paga(file_merged, plot=False)  # remove `plot=False` if you want to see the coarse-grained graph
sc.tl.umap(file_merged, init_pos='paga')
sc.tl.tsne(file_merged)</code></pre>
<pre class="highlight"><code class="language-python">sc.pp.neighbors(file_merged_bbknn, n_neighbors=10, n_pcs=30)
sc.tl.leiden(file_merged_bbknn)
sc.tl.paga(file_merged_bbknn)
sc.pl.paga(file_merged_bbknn, plot=False)  # remove `plot=False` if you want to see the coarse-grained graph
sc.tl.umap(file_merged_bbknn, init_pos='paga')
sc.tl.tsne(file_merged_bbknn)</code></pre>
<p>We can now plot the un-integrated and the integrated space reduced dimensions.</p>
<pre class="highlight"><code class="language-python">fig, axs = plt.subplots(2, 2, figsize=(10,8),constrained_layout=True)
sc.pl.tsne(file_merged_bbknn, color="batch", title="BBKNN Corrected tsne", ax=axs[0,0], show=False)
sc.pl.tsne(file_merged, color="batch", title="Uncorrected tsne", ax=axs[0,1], show=False)
sc.pl.umap(file_merged_bbknn, color="batch", title="BBKNN Corrected umap", ax=axs[1,0], show=False)
sc.pl.umap(file_merged, color="batch", title="Uncorrected umap", ax=axs[1,1], show=False)</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.tsne(file_merged, color='batch', title="Uncorrected umap", wspace=.5)
sc.pl.tsne(file_merged_bbknn, color= 'batch', title="BBKNN Corrected umap", wspace=.5)</code></pre>
<pre class="highlight"><code class="language-python">sc.tl.rank_genes_groups(file_merged_bbknn, 'batch', method='t-test')
sc.pl.rank_genes_groups(file_merged_bbknn, n_genes=25, sharey=False)</code></pre>
<pre class="highlight"><code class="language-python">sc.settings.verbosity = 2  # reduce the verbosity
sc.tl.rank_genes_groups(file_merged_bbknn, 'batch', method='wilcoxon')
sc.pl.rank_genes_groups(file_merged_bbknn, n_genes=25, sharey=False)</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn.write(results_file)</code></pre>
<pre class="highlight"><code class="language-python">pd.DataFrame(file_merged_bbknn.uns['rank_genes_groups']['names']).head(10)</code></pre>
<pre class="highlight"><code class="language-python">result = file_merged_bbknn.uns['rank_genes_groups']
groups = result['names'].dtype.names
pd.DataFrame(
    {group + '_' + key[:1]: result[key][group]
    for group in groups for key in ['names', 'pvals']}).head(10)</code></pre>
<pre class="highlight"><code class="language-python">sc.tl.rank_genes_groups(file_merged_bbknn, 'condition', groups=['IRF3&amp;IFNb'], reference='IRF3', method='wilcoxon')
sc.pl.rank_genes_groups(file_merged_bbknn, groups=['IRF3&amp;IFNb'], n_genes=20, fontsize=10)</code></pre>
<pre class="highlight"><code class="language-python">sc.tl.rank_genes_groups(file_merged_bbknn, 'condition', groups=['WT&amp;IFNb'], reference='WT', method='wilcoxon')
sc.pl.rank_genes_groups(file_merged_bbknn, groups=['WT&amp;IFNb'], n_genes=20, fontsize=10)</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.rank_genes_groups_violin(file_merged_bbknn, groups='WT&amp;IFNb', n_genes=8)</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn.obs</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.umap(file_merged_bbknn, color=['condition', 'batch'], wspace=.5)</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.tsne(file_merged_bbknn, color='leiden', legend_loc='on data', title='', frameon=False, save='.pdf')</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn.write(results_file)</code></pre>
<h1 id="cell-type-automatic-annotation-from-marker-genes">Cell type automatic annotation from marker genes<a class="headerlink" href="#cell-type-automatic-annotation-from-marker-genes" title="Permanent link"></a></h1>
<p>Using <code>decoupler</code></p>
<p>https://decoupler-py.readthedocs.io/en/latest/notebooks/cell_annotation.html</p>
<pre class="highlight"><code class="language-python">markers = dc.get_resource('PanglaoDB')
markers</code></pre>
<pre class="highlight"><code class="language-python"># Filter by canonical_marker and human
markers = markers[(markers['human']=='True')&amp;(markers['canonical_marker']=='True')]

# Remove duplicated entries
markers = markers[~markers.duplicated(['cell_type', 'genesymbol'])]
markers</code></pre>
<pre class="highlight"><code class="language-python">dc.run_ora(
    mat=file_merged_bbknn,
    net=markers,
    source='cell_type',
    target='genesymbol',
    min_n=3,
    verbose=True
)</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn</code></pre>
<p>Enrichment with Over Representation Analysis (ORA)</p>
<pre class="highlight"><code class="language-python">file_merged_bbknn.obsm['ora_estimate']</code></pre>
<pre class="highlight"><code class="language-python">acts = dc.get_acts(file_merged_bbknn, obsm_key='ora_estimate')

# We need to remove inf and set them to the maximum value observed for pvals=0
acts_v = acts.X.ravel()
max_e = np.nanmax(acts_v[np.isfinite(acts_v)])
acts.X[~np.isfinite(acts.X)] = max_e

acts</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.umap(acts, color=['NK cells', 'leiden'], cmap='RdBu_r')
sc.pl.violin(acts, keys=['NK cells'], groupby='leiden')</code></pre>
<pre class="highlight"><code class="language-python">df = dc.rank_sources_groups(acts, groupby='leiden', reference='rest', method='t-test_overestim_var')
df</code></pre>
<pre class="highlight"><code class="language-python">n_ctypes = 3
ctypes_dict = df.groupby('group').head(n_ctypes).groupby('group')['names'].apply(lambda x: list(x)).to_dict()
ctypes_dict</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.matrixplot(acts, ctypes_dict, 'leiden', dendrogram=True, standard_scale='var',
                 colorbar_title='Z-scaled scores', cmap='RdBu_r')</code></pre>
<pre class="highlight"><code class="language-python">sc.pl.violin(acts, keys=['T cells', 'B cells', 'Platelets', 'Monocytes', 'NK cells'], groupby='leiden')</code></pre>
<pre class="highlight"><code class="language-python">annotation_dict = df.groupby('group').head(1).set_index('group')['names'].to_dict()
annotation_dict</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn.obs['cell_type'] = [annotation_dict[clust] for clust in file_merged_bbknn.obs['leiden']]</code></pre>
<pre class="highlight"><code class="language-python"># Visualize
sc.pl.umap(file_merged_bbknn, color='cell_type')</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn.obs</code></pre>
<pre class="highlight"><code class="language-python">file_merged_bbknn.write(results_file)</code></pre>
<pre class="highlight"><code class="language-python">session_info.show()</code></pre>
<details>
<summary>Click to view session information</summary>
<pre>
-----
anndata             0.10.4
decoupler           1.5.0
matplotlib          3.8.2
numpy               1.26.3
pandas              2.2.0
scanpy              1.9.6
session_info        1.0.0
-----
</pre>
<details>
<summary>Click to view modules imported as dependencies</summary>
<pre>
PIL                         10.2.0
anyio                       NA
appnope                     0.1.3
asttokens                   NA
attr                        23.1.0
attrs                       23.1.0
babel                       2.11.0
brotli                      1.0.9
certifi                     2023.11.17
cffi                        1.16.0
charset_normalizer          2.0.4
comm                        0.2.1
cycler                      0.12.1
cython_runtime              NA
dateutil                    2.8.2
debugpy                     1.6.7
decorator                   5.1.1
defusedxml                  0.7.1
executing                   2.0.1
fastjsonschema              NA
h5py                        3.10.0
idna                        3.4
ipykernel                   6.29.0
jedi                        0.19.1
jinja2                      3.1.2
joblib                      1.3.2
json5                       NA
jsonschema                  4.19.2
jsonschema_specifications   NA
jupyter_events              0.8.0
jupyter_server              2.10.0
jupyterlab_server           2.25.1
kiwisolver                  1.4.5
llvmlite                    0.41.1
markupsafe                  2.1.3
matplotlib_inline           0.1.6
mpl_toolkits                NA
natsort                     8.4.0
nbformat                    5.9.2
numba                       0.58.1
overrides                   NA
packaging                   23.2
parso                       0.8.3
patsy                       0.5.6
pexpect                     4.8.0
pickleshare                 0.7.5
pkg_resources               NA
platformdirs                4.1.0
prometheus_client           NA
prompt_toolkit              3.0.42
psutil                      5.9.0
ptyprocess                  0.7.0
pure_eval                   0.2.2
pycparser                   2.21
pydev_ipython               NA
pydevconsole                NA
pydevd                      2.9.5
pydevd_file_utils           NA
pydevd_plugins              NA
pydevd_tracing              NA
pygments                    2.17.2
pynndescent                 0.5.11
pyparsing                   3.1.1
pythonjsonlogger            NA
pytz                        2023.3.post1
referencing                 NA
requests                    2.31.0
rfc3339_validator           0.1.4
rfc3986_validator           0.1.1
rpds                        NA
scipy                       1.12.0
send2trash                  NA
six                         1.16.0
sklearn                     1.4.0
sniffio                     1.3.0
socks                       1.7.1
stack_data                  0.6.2
statsmodels                 0.14.1
threadpoolctl               3.2.0
tornado                     6.3.3
tqdm                        4.66.1
traitlets                   5.14.1
typing_extensions           NA
umap                        0.5.5
urllib3                     1.26.18
wcwidth                     0.2.13
websocket                   0.58.0
yaml                        6.0.1
zmq                         25.1.2
</pre>
</details> <!-- seems like this ends pre, so might as well be explicit -->
<pre>
-----
IPython             8.20.0
jupyter_client      8.6.0
jupyter_core        5.5.0
jupyterlab          4.0.8
notebook            7.0.6
-----
Python 3.11.7 (main, Dec 15 2023, 12:09:56) [Clang 14.0.6 ]
macOS-14.2.1-arm64-arm-64bit
-----
Session information updated at 2024-01-30 16:02
</pre>
</details>

<pre class="highlight"><code class="language-python"></code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2024 <a href="https://www.linkedin.com/in/lamine-toure">Lamine TOURE</a>, Maintained by <a href="https://github.com/LamineTourelab">Lamine TOURE</a>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../../js/jquery-3.6.0.min.js"></script>
        <script src="../../../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
